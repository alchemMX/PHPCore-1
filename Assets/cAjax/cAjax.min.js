!function(t){var a=t('[ajax-selector="window"]'),e=t('[ajax-selector="loading"]'),o=t('[ajax-selector="window-alert"]');jQuery.cAjax=function(d,i){t("body").on("click",'[ajax="'+d+'"]',function(s){s.preventDefault(),s.stopImmediatePropagation(),e.show();var n="",w=n=t(this);n.data("id")||t.each(["block","field","list-row"],function(t,a){if(w.closest('[ajax-selector="'+a+'"]').length)return n=w.closest('[ajax-selector="'+a+'"]').first(),!0}),i.id=n.attr("data-id"),i.type=n.attr("data-type"),i.process=n.attr("data-type")?i.type+"/"+d.substr(0,1).toUpperCase()+d.substr(1):null,i.ajax&&("post"==i.ajax.method?(delete i.ajax.context.id,delete i.ajax.context.method,delete i.ajax.context.process):(i.ajax.context.id=i.id,i.ajax.context.method=i.ajax.method,i.process&&(i.ajax.context.process=i.process))),i.onload&&i.onload.call(w,i,n),methods={ajax:{get:function(){t.get(i.ajax.url,i.ajax.context,function(t){methods.finish(t)})},post:function(){t.post(i.ajax.url+"?id="+i.id+(i.process?"&process="+i.process:"")+"&method=post",i.ajax.context,function(t){methods.finish(t)})}},finish:function(d){return e.hide(),i.data=t.parseJSON(d),"ok"!=i.data.status?("error"==i.data.status&&(o.removeClass("window-hide").addClass("window-active").removeClass("window-alert-success"),o.find('[ajax-selector="window-alert-body"]').text(i.data.error),setTimeout(function(){o.addClass("window-hide").removeClass("window-active")},1500)),!1):i.data.redirect?(window.location.href=i.data.redirect,!0):(i.data.message&&(o.removeClass("window-hide").addClass("window-active").addClass("window-alert-success"),o.find('[ajax-selector="window-alert-body"]').text(i.data.message),setTimeout(function(){o.addClass("window-hide").removeClass("window-active")},1500)),1==i.refresh&&location.reload(),i.success.call(w,i,n),void a.removeClass("window-active"))}},i.window&&(i.window.context.id=i.id,i.window.context.process=i.process,t.get(i.window.url,i.window.context,function(o){if(i.data=t.parseJSON(o),e.hide(),"ok"!=i.data.status)return!1;a.addClass("window-active"),a.find('[ajax-selector="window-title"]').text(i.data.windowTitle),a.find('[ajax-selector="window-description"]').text(i.data.windowDesc),i.data.windowContent?a.find('[ajax-selector="window-body"]').html(i.data.windowContent):a.find('[ajax-selector="window-body"]').empty(),i.data.windowSubmit?(a.find('[ajax-selector="window-bottom"]').show(),a.find('[ajax-selector="window-submit"]').text(i.data.windowSubmit),a.find('[ajax-selector="window-cancel"]').text(i.data.windowClose)):a.find('[ajax-selector="window-bottom"]').hide(),i.window.onload&&i.window.onload.call(a,i)})),i.ajax&&(i.window?t('[ajax="confirm"]').on("click",function(t){t.preventDefault(),t.stopImmediatePropagation(),e.show(),i.window.submit&&i.window.submit.call(a,i),"post"==i.ajax.method?methods.ajax.post():methods.ajax.get()}):"post"==i.ajax.method?methods.ajax.post():methods.ajax.get())})}}(jQuery);